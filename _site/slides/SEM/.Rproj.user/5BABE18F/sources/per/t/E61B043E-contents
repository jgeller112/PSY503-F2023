---
title: "Mediation Analysis in R"
author: "Jason Geller, PH.D."
subtitle: \center{"Princeton University"}
footer: "PSY 504"
format: 
  revealjs:
    theme: psy504.css
    multiplex: true
    transition: fade
    slide-number: true
    incremental: false 
    chalkboard: true
execute:
  freeze: auto
  echo: true
  message: false
  warning: false
---

## What is SEM?

A broad and extremely versatile multivariate framework

-   Two types

    -   **Path analysis**

    -   measurement (CFA)

```{=html}
<!-- -->
```
-   Test and quantify theories

-   Measurement error

## Why SEM

-   Highly theory drive

-   Model latent variables

-   Model multiple DVs

-   Model direct and indirect relationships

## SEM Mantra

-   Specify - What are the hypothesized relationships (ivs, dvs, mediators, mediators)

-   Identify - Do you have an unidentified, just-identified (df = 0), or over-identified model (df \> 0)

-   Estimate (ML)

-   Evaluate: Good fit (data should fit the model)

-   Modify - mod indices

## Guide

-   Weston and gore (2006)

![](images/sem_guide.png){fig-align="center"}

## Key concepts

-   exo: no arrows pointed

-   end: pointed errors

-   A variable can be both (example?)

## Recursive vs. Non-cursive

-   Diff between the two

    -   DO I have feedback loops (non-recursive)

    -   Makes no sense (think the opposite)

## Fit indices

-   chi-square (sensitive to sample size) data vs. model (How closely are they)

-   CFI: target vs. null model (\> .9)

-   TLI: small samples (\> .9)

-   RMSEA (\< .08 or \<.05) (parsimony)

-   SRMSR (square-root of the difference between the residuals of the sample covariance

*easystats interpret()*

## Disadvantages

-   High causal

-   Theory driven

-   Sample size (high)

-   Complex

## The data

Honest-humility

Prosocial behavior

Connectedness

nation

all humanity

connected to nature

## Pacman

```{r}
library(pacman)
p_load(tidyverse, haven, ggplot2, lavaan, semPlot)

```

```{r}

model1 <- '
PSB~PP+CH'

model1.fit<- sem(model1, data=data)

summary(model1.fit, fit.measures=TRUE, standardized=T, rsquare=T)

semPaths(model1.fit)


```

```{r}

# control vars
# just add
# full model

PP ~ b + c + covar

```

## Parallell mediation

```{r}


model4 <- '
clc ~ a1*PP
ch~a2*PP
CNation ~ a3*PP
Cnature ~ a4*PP


PSB ~ b1*CLC +b2*CH + b3*CNation + b4*CNature + c*PP

#indirect effects.

indirect1 := 



```

```{r}

model_paths()
compareLavaan

```

## CFA

-   Scaling issue

-   1 factor loading = 1

## Modifications

-   modificationindices()

## Questions

-   Can this do ordinal analysis?

-   Effect size?

-   
